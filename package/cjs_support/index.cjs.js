"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var l=require("react");function S(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var b=S(l),E={exports:{}},f={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var w=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;function j(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function R(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de",Object.getOwnPropertyNames(r)[0]==="5")return!1;for(var e={},o=0;o<10;o++)e["_"+String.fromCharCode(o)]=o;var n=Object.getOwnPropertyNames(e).map(function(c){return e[c]});if(n.join("")!=="0123456789")return!1;var t={};return"abcdefghijklmnopqrst".split("").forEach(function(c){t[c]=c}),Object.keys(Object.assign({},t)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}R();/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T=b.default,_=60103;f.Fragment=60107;if(typeof Symbol=="function"&&Symbol.for){var m=Symbol.for;_=m("react.element"),f.Fragment=m("react.fragment")}var I=T.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p=Object.prototype.hasOwnProperty,U={key:!0,ref:!0,__self:!0,__source:!0};function h(r,e,o){var n,t={},c=null,i=null;o!==void 0&&(c=""+o),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)p.call(e,n)&&!U.hasOwnProperty(n)&&(t[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)t[n]===void 0&&(t[n]=e[n]);return{$$typeof:_,type:r,key:c,ref:i,props:t,_owner:I.current}}f.jsx=h;f.jsxs=h;E.exports=f;const k=E.exports.jsx,D="riskid_sdk_script",x="SDK init error",g="SDK load error",C="Error sending action event",K="Error authenticating user",z="Error clearing user";function N(r){let e=!1,o=!1,n=r.then(function(t){return o=!0,t},function(t){throw e=!0,t});return o?n.status="fulfilled":e?n.status="rejected":n.status="pending",n}const d=(r,e)=>({message:e,err:r}),$=r=>`https://cdn.riskid.security/sdk/web_sdk_${r}.js`,F=(r,e,o)=>{if(typeof document=="undefined"||document.getElementById(r))throw new Error("SDK already loaded or cannot be loaded");return new Promise((n,t)=>{const c=document.createElement("script"),i=$(e);c.defer=!0,c.src=i,c.id=r,c.onload=()=>n(),c.onerror=()=>t(),o||(o=document.head),o.appendChild(c)})},L=(r,e)=>{var o,n;return{initialized:!1,clientId:r,serverUrl:(o=e==null?void 0:e.serverPath)!=null?o:"https://collect.riskid.security/",sdkVersion:(n=e==null?void 0:e.sdkVersion)!=null?n:"latest",...(e==null?void 0:e.userId)&&{userId:e.userId},onError:(e==null?void 0:e.onError)&&typeof e.onError=="function"?e==null?void 0:e.onError:t=>{console.log(t)}}},v=l.createContext(void 0),q=(r,e)=>({...r,...e});function V({children:r,clientId:e,options:o}){if(!e)throw new Error("No clientId was provided");let n;const t=L(e,o);t.initialized=new Promise(y=>{let s=!1;n=a=>{s||(s=!0,y(a))}});const[c,i]=l.useReducer(q,t),u=l.useMemo(()=>({state:c,dispatch:i}),[c,i]);return l.useEffect(()=>{let y;try{y=F(D,t.sdkVersion)}catch{return}y.then(async()=>{if(N(t.initialized).status!="fulfilled"&&!window.myTSAccountProtection)try{const a=t.serverUrl;console.log(`Initializes AccountProtection SDK with { clientId: ${t.clientId}, serverUrl: ${a} }`),window.myTSAccountProtection=new TSAccountProtection(t.clientId,{serverPath:a});try{await window.myTSAccountProtection.init(t==null?void 0:t.userId),n(!0)}catch(P){t.onError(d(P,x)),n(!1)}}catch(a){t.onError(d(a,g)),n(!1)}}).catch(s=>{t.onError(d(s,g)),n(!1)})},[]),k(v.Provider,{value:u,children:r})}function M(r){return async function(o,n={}){var t;if(await r.initialized)try{return await((t=window.myTSAccountProtection)==null?void 0:t.triggerActionEvent(o,n))}catch(c){r.onError(d(c,C))}return null}}function B(r,e){return async function(n,t={}){var c;if(await r.initialized)try{return e({...r,userId:n}),await((c=window.myTSAccountProtection)==null?void 0:c.setAuthenticatedUser(n,t))}catch(i){r.onError(d(i,K))}return!1}}function G(r,e){return async function(n={}){var t;if(await r.initialized)try{const{userId:c,...i}=r;return e({...i}),await((t=window.myTSAccountProtection)==null?void 0:t.clearUser(n))}catch(c){r.onError(d(c,z))}return!1}}const H=()=>{const r=l.useContext(v);if(r===void 0)throw new Error("`useTSAccountProtection` must be used within App");return r},J=()=>{const{state:r,dispatch:e}=H();return{triggerActionEvent:M(r),setAuthenticatedUser:B(r,e),clearUser:G(r,e)}};exports.TSAccountProtectionProvider=V;exports.useTSAccountProtection=J;
//# sourceMappingURL=index.cjs.js.map
